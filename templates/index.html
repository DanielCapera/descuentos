<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio - Descuentos Reales</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <header>
        <h1>Descubre Descuentos Reales, No Trucos de Marketing</h1>
        <p>¿Los descuentos en línea son realmente ofertas o solo estrategias de marketing? La herramienta Detector de
            Descuentos usa inteligencia artificial para analizar el historial de precios y ayudarte a identificar si una
            oferta es genuina. No vuelvas a caer en falsos descuentos y ahorra de verdad con información transparente y
            confiable.</p>
    </header>

    <div class="container">
        <h2>Productos Analizados</h2>
        <div id="productos-container" class="productos-grid">
            {% for producto in productos %}
            <div class="product">
                <img src="{{ producto.imagen }}" alt="{{ producto.modelo }}">
                <h3>{{ producto.modelo }}</h3>
                <p>Precio: {{ producto.precio_actual | format_price }}</p>
                <a href="{{ url_for('detalle_producto', modelo=producto.modelo) }}" class="btn">Ver Detalle</a>
            </div>
            {% endfor %}
        </div>

        <button id="ver-mas" class="btn-mas">Ver Más</button>

        <h2>Nuestros usuarios avalan nuestra aplicación</h2>
        <div class="testimonials">
            <div class="testimonial">
                <p>"¡Me ayudó a ahorrar dinero! Muy recomendable."</p>
                <span>- Usuario 1</span>
            </div>
            <div class="testimonial">
                <p>"Antes caía en falsas ofertas, ahora tengo información real."</p>
                <span>- Usuario 2</span>
            </div>
            <div class="testimonial">
                <p>"Es la mejor herramienta para encontrar descuentos genuinos."</p>
                <span>- Usuario 3</span>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Descuentos Reales</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let skip = 9;
            let button = document.getElementById("ver-mas");

            button.addEventListener("click", function () {
                fetch("/api/load_more", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ skip: skip }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.productos.length > 0) {
                        let container = document.getElementById("productos-container");
                        data.productos.forEach(producto => {
                            let div = document.createElement("div");
                            div.classList.add("product");
                            div.innerHTML = `
                                <img src="${producto.imagen}" alt="${producto.modelo}">
                                <h3>${producto.modelo}</h3>
                                <p>Precio: ${producto.precio_actual}</p>
                                <a href="#" class="btn">Ver Detalle</a>
                            `;
                            container.appendChild(div);
                        });

                        // Aplicar nuevamente la clase para mantener la grilla
                        container.classList.add("productos-grid");

                        skip += data.productos.length;
                    }

                    if (!data.has_more) {
                        button.style.display = "none";
                    }
                });
            });
        });
    </script>

</body>
</html>
